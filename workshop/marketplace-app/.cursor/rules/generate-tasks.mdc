---
description: Break down a PRD into an executable task list with checkbox tracking. Two-phase: parent tasks first, then subtasks after user says "Go".
globs:
alwaysApply: false
---

# Generate Task List

You are a senior engineer breaking down a PRD into executable tasks for a marketplace platform.

## Stack Context

This is a marketplace platform built with:
- **Backend**: TypeScript + Express.js, raw SQL with pg (node-postgres)
- **Frontend**: TypeScript + Nuxt 3 (Vue 3), Tailwind CSS
- **Architecture**: Microservices (product-service on :8001, user-service on :8002)
- **Database**: PostgreSQL (no ORM)
- **Testing**: Vitest (backend + frontend)

## Coding Conventions

All generated tasks must enforce these project conventions in their descriptions and acceptance criteria:
- Error responses: `{ detail: "Error message" }` with appropriate HTTP status codes
- TypeScript interfaces for all data types (no classes)
- Express.js routers for route organization
- Imports always at the top of files, never inside functions
- `.js` extensions in TypeScript imports (NodeNext module resolution)
- Tests co-located in `src/__tests__/` directories (backend) or `__tests__/` (frontend)
- No ORM â€” raw SQL with the `pg` (node-postgres) library
- Vitest for all tests (backend + frontend)
- Test-first development: write tests before implementation in every task

**Input**: Read the PRD file at `tasks/prd-[feature-name].md` completely before generating any tasks.

---

## Phase 1: Generate Parent Tasks

Generate ONLY the parent tasks first. Use checkbox format. Always start with Task 0.0.

```markdown
# Task List: [Feature Name]

**PRD**: tasks/prd-[feature-name].md
**Generated**: [date]

## Relevant Files
- [List key files that will be created or modified]
- [Include test file paths]

## Tasks

- [ ] 0.0 - Create feature branch from main
- [ ] 1.0 - [First parent task title]
- [ ] 2.0 - [Second parent task title]
- [ ] 3.0 - [Third parent task title]
- [ ] 4.0 - [Fourth parent task title (if needed)]
- [ ] 5.0 - [Fifth parent task title (if needed)]
```

**Rules for parent tasks:**
- 3-5 parent tasks max (plus task 0.0). If you need more, the PRD scope is too big.
- Tasks numbered in execution order.
- Always include Task 0.0: Create feature branch.

After generating parent tasks, **STOP and wait**. Say: "Parent tasks generated. Type 'Go' to generate subtasks."

---

## Phase 2: Generate Subtasks

Only after I say "Go", expand each parent into subtasks.

```markdown
- [ ] 0.0 - Create feature branch from main
- [ ] 1.0 - [Parent task title]
  - [ ] 1.1 - [Subtask title]
  - [ ] 1.2 - [Subtask title]
  - [ ] 1.3 - [Subtask title]
- [ ] 2.0 - [Parent task title]
  - [ ] 2.1 - [Subtask title]
  - [ ] 2.2 - [Subtask title]
```

**Subtask rules:**
- 2-6 subtasks per parent. More than 6 = split the parent.
- Each subtask completable in one AI session (under 30 min).
- One concern per subtask: a model OR an endpoint OR a component.
- Tests are included in each implementation subtask, not separate.
- Happy path first, edge cases last under each parent.

---

## Subtask Detail Format

```markdown
- [ ] 1.1 - [Title]
  **Type**: backend | frontend | infrastructure | database
  **Depends on**: [task numbers, or "none"]
  **Files**: [files to create or modify]
  **Description**: [2-4 sentences]
  **Acceptance Criteria**:
  - [Specific, testable condition]
  - Tests pass: [what tests verify]
```

---

## Relevant Files Section

Maintain at the top. Update as tasks are generated:

```markdown
## Relevant Files
- backend/product-service/src/routes/bids.ts (create)
- backend/product-service/src/__tests__/bids.test.ts (create)
- frontend/pages/products/[id].vue (modify)
- frontend/components/BidCard.vue (create)
- frontend/__tests__/BidCard.test.ts (create)
```

---

## Save the Task List

Save to: `tasks/tasks-[feature-name].md`

Same kebab-case name as the PRD.
